#include <math.h> 
 #include <string.h> 
#include "./include/k2c_include.h" 
#include "./include/k2c_tensor_include.h" 

 


void MNIST_CNN(k2c_tensor* conv2d_input_input, k2c_tensor* dense_output) { 

size_t conv2d_stride[2] = {1,1}; 
size_t conv2d_dilation[2] = {1,1}; 
float conv2d_output_array[2704] = {0}; 
k2c_tensor conv2d_output = {&conv2d_output_array[0],3,2704,{26,26, 4, 1, 1}}; 
float conv2d_kernel_array[36] = {
+1.04211378e+00f,-9.27497447e-02f,-1.16535795e+00f,+1.26563287e+00f,+1.09527659e+00f,
-1.05926085e+00f,+1.20816100e+00f,+6.13168716e-01f,+1.05740237e+00f,-1.76462722e+00f,
+8.85663629e-01f,-6.65059865e-01f,+7.34754801e-01f,-1.35489964e+00f,-1.40378046e+00f,
-1.51928619e-01f,+9.60779488e-02f,-2.73061037e-01f,+5.78836501e-01f,+7.45528758e-01f,
+2.93760449e-01f,+4.13353175e-01f,+4.54926826e-02f,+3.13090414e-01f,+7.97632456e-01f,
-6.77023828e-01f,+8.62874269e-01f,-1.30884171e+00f,+1.71767756e-01f,+1.10948503e+00f,
+1.18882120e+00f,+2.85734922e-01f,+4.87730414e-01f,+1.27600443e+00f,+8.59856427e-01f,
+9.20040011e-01f,}; 
k2c_tensor conv2d_kernel = {&conv2d_kernel_array[0],4,36,{3,3,1,4,1}}; 
float conv2d_bias_array[4] = {
+1.25046764e-02f,-4.39317897e-04f,-1.98360975e-03f,-4.87790704e-01f,}; 
k2c_tensor conv2d_bias = {&conv2d_bias_array[0],1,4,{4,1,1,1,1}}; 

 
size_t max_pooling2d_stride[2] = {4,4}; 
size_t max_pooling2d_pool_size[2] = {4,4}; 
float max_pooling2d_output_array[144] = {0}; 
k2c_tensor max_pooling2d_output = {&max_pooling2d_output_array[0],3,144,{6,6,4,1,1}}; 


size_t conv2d_1_stride[2] = {1,1}; 
size_t conv2d_1_dilation[2] = {1,1}; 
float conv2d_1_output_array[128] = {0}; 
k2c_tensor conv2d_1_output = {&conv2d_1_output_array[0],3,128,{4,4,8,1,1}}; 
float conv2d_1_kernel_array[288] = {
-2.03906327e-01f,-3.25205699e-02f,-3.64564449e-01f,+1.13071688e-01f,-6.53550625e-02f,
+2.70733446e-01f,+1.53873831e-01f,+3.13562870e-01f,-1.53345406e-01f,+3.52755874e-01f,
-1.47889350e-02f,+5.90659454e-02f,-4.96042013e-01f,+6.16456151e-01f,-1.31091371e-01f,
+2.06738234e-01f,-3.76952052e-01f,-1.39205500e-01f,-8.69105607e-02f,-1.61096215e-01f,
-1.31418347e-01f,-9.67717618e-02f,+3.36331487e-01f,+1.21577457e-01f,-5.86846948e-01f,
-4.07941610e-01f,-1.44739985e-01f,-4.29752082e-01f,+2.61294782e-01f,+7.90915117e-02f,
+3.70964348e-01f,-1.30160660e-01f,-5.01338653e-02f,+3.51739168e-01f,+3.69396806e-01f,
+1.06963180e-01f,-1.12016283e-01f,-1.75082073e-01f,-2.25026235e-01f,-1.59131214e-01f,
+2.99420834e-01f,+3.40896875e-01f,-9.64499861e-02f,-5.99600613e-01f,+5.64388752e-01f,
-2.62380224e-02f,+2.92340100e-01f,-4.87193197e-01f,+3.27235341e-01f,+3.48136544e-01f,
+2.68273473e-01f,-5.25729597e-01f,+1.89855799e-01f,-2.51055598e-01f,+1.31990433e-01f,
+1.68302506e-02f,-5.85442670e-02f,+7.21914530e-01f,-2.23912090e-01f,-2.82090932e-01f,
-2.13416100e-01f,-1.25945434e-01f,-3.18872631e-02f,-5.77251256e-01f,+2.01763406e-01f,
+6.23603389e-02f,-2.01792479e-01f,-4.24622655e-01f,+2.57548451e-01f,-4.64907944e-01f,
+3.07822734e-01f,-1.69788301e-01f,-7.91705251e-02f,+3.82019095e-02f,+2.76781559e-01f,
-4.47320759e-01f,+8.51308286e-01f,-4.09140140e-01f,+5.07376909e-01f,+3.92233282e-01f,
+2.08541617e-01f,+1.30981773e-01f,-1.90865889e-01f,-1.29240990e-01f,+2.68543243e-01f,
-2.64948010e-01f,+8.28202367e-01f,-1.83021843e-01f,+2.44908646e-01f,-2.32072622e-01f,
-5.91450036e-01f,-2.14277461e-01f,+2.62175351e-02f,+6.30408973e-02f,-5.30548096e-01f,
-7.08820283e-01f,-3.34408998e-01f,-3.14330697e-01f,+1.40281618e-02f,-1.18446223e-01f,
-1.79714084e-01f,-5.17525077e-02f,+1.42938152e-01f,-1.18244849e-02f,-7.87009113e-03f,
-1.21899404e-01f,-1.44727111e-01f,+5.63761771e-01f,+7.77788535e-02f,+7.26788640e-01f,
-1.53214768e-01f,-1.07204840e-01f,-3.03736150e-01f,-2.51408964e-01f,+1.22749433e-01f,
-2.62640327e-01f,+7.18455538e-02f,-2.05269903e-01f,+3.47083688e-01f,-4.80124764e-02f,
-2.83856660e-01f,-3.25153619e-01f,+5.71361184e-01f,-3.98068100e-01f,-1.53896399e-02f,
-3.52186412e-01f,-1.30130842e-01f,-3.86676282e-01f,+2.83688068e-01f,+2.06312731e-01f,
+2.28608787e-01f,-1.95710644e-01f,-1.57260261e-02f,+2.33405262e-01f,+2.66978182e-02f,
-3.70001674e-01f,-2.07028180e-01f,+9.09414515e-02f,-3.91837597e-01f,+3.89752328e-01f,
-4.61179197e-01f,+3.11891377e-01f,-3.40363741e-01f,-1.29844919e-01f,+7.99344122e-01f,
-1.03272505e-01f,-1.54316518e-02f,-8.38956684e-02f,-1.03113182e-01f,-9.57620665e-02f,
+2.37340257e-01f,-3.14341754e-01f,-3.38657759e-02f,-3.61895412e-01f,-7.06122145e-02f,
-4.24965501e-01f,+3.35743576e-01f,+7.78327465e-01f,-2.22099781e-01f,-2.80455977e-01f,
-2.15568040e-02f,-8.97312164e-02f,-4.48126823e-01f,+2.97262575e-02f,-3.85050267e-01f,
-1.73785314e-02f,+7.48637170e-02f,+1.35311946e-01f,-3.69322225e-02f,-3.66833121e-01f,
+8.83960053e-02f,-3.25326383e-01f,-1.01034850e-01f,-6.85836911e-01f,-1.83939904e-01f,
+9.52915568e-03f,-8.24797377e-02f,+1.79615393e-01f,-2.71989912e-01f,+1.03606686e-01f,
-4.84597981e-01f,-3.92672479e-01f,-1.48902833e-01f,+2.79455870e-01f,-4.40393053e-02f,
-2.23519251e-01f,-7.48468935e-02f,+2.67701577e-02f,+4.19035822e-01f,+6.06274426e-01f,
+3.30896489e-02f,-9.17568564e-01f,-3.65819633e-01f,+1.65684626e-01f,+4.08850402e-01f,
+4.72597420e-01f,+1.74887866e-01f,+4.31402922e-02f,+1.48429886e-01f,+8.79003927e-02f,
-7.89815038e-02f,+6.86255336e-01f,+4.49402988e-01f,+2.54670292e-01f,+2.51617253e-01f,
+6.30070090e-01f,-5.45996964e-01f,+2.90706515e-01f,+5.68662956e-02f,+4.17500623e-02f,
+2.36528710e-01f,+1.49531350e-01f,+4.22599345e-01f,+9.45058465e-02f,+4.07864630e-01f,
+3.35903257e-01f,-2.82193720e-01f,-2.88876444e-01f,-9.99423414e-02f,-7.10488081e-01f,
+6.45172060e-01f,+3.75339799e-02f,+2.19085395e-01f,-5.11392236e-01f,+4.22090590e-01f,
-7.78232701e-03f,+4.46161538e-01f,+3.00315797e-01f,-4.28208739e-01f,+2.91816592e-01f,
-3.81003618e-01f,+3.02911066e-02f,-9.42203403e-01f,+7.32425928e-01f,+8.34569260e-02f,
-4.06058371e-01f,+1.10483599e+00f,+1.12794304e+00f,-3.51307243e-01f,+5.26731789e-01f,
+4.75190014e-01f,+2.43019998e-01f,+7.27781951e-02f,-6.65491372e-02f,+3.29661310e-01f,
+4.39780176e-01f,+1.68826461e-01f,+5.14287293e-01f,+3.08630258e-01f,-7.26654708e-01f,
+2.15080023e-01f,+5.92961311e-01f,+3.92769068e-01f,-3.21604103e-01f,+9.46591914e-01f,
-9.67177749e-01f,-2.33356550e-01f,-3.77826214e-01f,+1.53529137e-01f,+2.95214057e-01f,
-3.17013979e-01f,+2.81859010e-01f,-3.28639984e-01f,+2.89063513e-01f,-1.48389027e-01f,
+3.86937469e-01f,+1.48187831e-01f,-2.90476531e-01f,+4.93778527e-01f,-1.42667457e-01f,
-5.07245541e-01f,+8.17054287e-02f,+9.90529954e-02f,+5.03956601e-02f,+5.03805637e-01f,
+2.29440350e-03f,+2.98617105e-03f,+5.47791481e-01f,-1.67431757e-01f,+3.61261785e-01f,
+5.64202547e-01f,-5.63228130e-01f,+1.62271410e-02f,+1.16901541e+00f,+5.84473670e-01f,
-3.05052638e-01f,+6.11452579e-01f,-4.91362333e-01f,}; 
k2c_tensor conv2d_1_kernel = {&conv2d_1_kernel_array[0],4,288,{3,3,4,8,1}}; 
float conv2d_1_bias_array[8] = {
-7.63925612e-02f,+5.12274563e-01f,+1.43959140e-02f,+3.55612874e-01f,-3.46234053e-01f,
-1.42562538e-01f,-3.41861933e-01f,+9.45729494e-01f,}; 
k2c_tensor conv2d_1_bias = {&conv2d_1_bias_array[0],1,8,{8,1,1,1,1}}; 

 
size_t max_pooling2d_1_stride[2] = {2,2}; 
size_t max_pooling2d_1_pool_size[2] = {2,2}; 
float max_pooling2d_1_output_array[32] = {0}; 
k2c_tensor max_pooling2d_1_output = {&max_pooling2d_1_output_array[0],3,32,{2,2,8,1,1}}; 


float flatten_output_array[32] = {0}; 
k2c_tensor flatten_output = {&flatten_output_array[0],1,32,{32, 1, 1, 1, 1}}; 
float dense_kernel_array[320] = {
+3.95947024e-02f,+2.80842036e-01f,-3.99555176e-01f,-4.94258434e-01f,+2.82095699e-03f,
+4.20197010e-01f,+2.86980480e-01f,-3.47833276e-01f,+1.12360887e-01f,+3.61927420e-01f,
+3.75068337e-01f,-8.05648565e-02f,+5.77590108e-01f,-7.59997591e-02f,+1.36002541e-01f,
-2.74251252e-01f,-1.50455192e-01f,+1.07321835e+00f,-5.36420166e-01f,-7.85600364e-01f,
-5.23048341e-01f,-8.71837974e-01f,+1.84274659e-01f,+8.19717944e-02f,+4.44370806e-01f,
-2.19431996e-01f,+5.75514957e-02f,+3.15056115e-01f,-9.95863602e-02f,-3.74393702e-01f,
-1.68649461e-02f,+1.05423987e-01f,+2.13132277e-01f,-5.40945292e-01f,-4.60500568e-01f,
+2.32169494e-01f,-6.17748320e-01f,+7.36482739e-01f,+1.72534525e-01f,+2.13333711e-01f,
-2.63240039e-01f,-1.01563776e+00f,-7.77186081e-02f,-1.55327067e-01f,+3.32073897e-01f,
-1.45017892e-01f,-1.72362700e-02f,-1.73899218e-01f,+2.43489996e-01f,+6.10940397e-01f,
+5.72119793e-03f,-2.45427594e-01f,+1.65982395e-01f,+3.89931589e-01f,+9.05965269e-02f,
-3.96491438e-02f,-5.20337164e-01f,+1.38883907e-02f,-2.84452319e-01f,+3.49618703e-01f,
+5.57425082e-01f,-3.36165458e-01f,-4.09745961e-01f,-6.22889876e-01f,+3.60043161e-02f,
+1.80333823e-01f,+7.14670271e-02f,-2.74284929e-01f,-2.24945903e-01f,+2.01652255e-02f,
+3.26103002e-01f,+6.86032236e-01f,-2.90647205e-02f,-4.93911117e-01f,+2.67122418e-01f,
+1.76198497e-01f,+4.23711866e-01f,-5.03586292e-01f,-3.73545080e-01f,+2.10626498e-01f,
+1.93871066e-01f,+2.88041055e-01f,-4.17722315e-01f,+3.71139556e-01f,+7.00314879e-01f,
-7.77337492e-01f,+2.56945491e-01f,-3.56126815e-01f,-1.78496577e-02f,-2.96472311e-01f,
-4.79940116e-01f,-4.62441355e-01f,+3.31416368e-01f,-1.44718289e-01f,-2.87442952e-01f,
-2.94609666e-01f,+1.26812398e-01f,+3.85650992e-01f,-7.39260256e-01f,+2.81624854e-01f,
-2.79996872e-01f,+6.89638481e-02f,-4.20455560e-02f,+9.92805138e-02f,+2.10477054e-01f,
-3.95163596e-01f,+2.13415548e-01f,-1.11974645e-02f,-4.84935641e-01f,-5.05367756e-01f,
+1.71175942e-01f,-5.84779918e-01f,-5.19553006e-01f,-3.32528412e-01f,-3.40239316e-01f,
+2.88351059e-01f,+3.77833635e-01f,+8.10591638e-01f,-5.29240131e-01f,+8.97088945e-02f,
-4.03635323e-01f,-4.82717246e-01f,-2.99550742e-01f,-5.04840314e-01f,+9.83190611e-02f,
+5.19802511e-01f,+5.63304007e-01f,-3.72733861e-01f,+2.04666015e-02f,-3.64396125e-01f,
-1.93142444e-01f,-4.28293914e-01f,+2.96865970e-01f,+5.03426015e-01f,-3.30907464e-01f,
-8.10784280e-01f,-2.54581928e-01f,-1.80511236e-01f,+1.95088923e-01f,+8.21641803e-01f,
-5.00499785e-01f,+2.21266240e-01f,-5.03632605e-01f,+1.44084066e-01f,+3.33078325e-01f,
+4.71477419e-01f,-5.00130415e-01f,-3.76656689e-02f,+2.22504675e-01f,-4.27443266e-01f,
-6.93865716e-01f,+4.62451935e-01f,-5.02196312e-01f,-4.28291976e-01f,+6.62445307e-01f,
+5.25883675e-01f,+6.19366109e-01f,-2.78127670e-01f,-5.42540073e-01f,-1.82743117e-01f,
+2.97554225e-01f,+1.51147395e-01f,-3.67395766e-03f,-4.52285469e-01f,-1.45321652e-01f,
-2.66692430e-01f,+2.63708562e-01f,-1.01385549e-01f,+3.35410118e-01f,-8.71777013e-02f,
-4.09021556e-01f,+2.79453546e-01f,-5.96435547e-01f,+2.73185253e-01f,+8.21426392e-01f,
+2.83676356e-01f,-1.02143979e+00f,+8.46831277e-02f,-2.39166543e-01f,+3.63481224e-01f,
+7.41758168e-01f,-4.12219435e-01f,-1.82854503e-01f,+8.02800953e-02f,-7.43246749e-02f,
+1.40514091e-01f,+4.27751392e-01f,-4.90357280e-01f,-4.98599201e-01f,+3.42970304e-02f,
-6.07414186e-01f,-3.10833335e-01f,+4.73092407e-01f,-4.81076874e-02f,-7.19764471e-01f,
+1.17774285e-01f,-4.63298500e-01f,-2.46223718e-01f,-3.39914292e-01f,-7.45515943e-01f,
+5.40613122e-02f,-3.76168549e-01f,-1.50399685e-01f,+6.62099242e-01f,-5.82010150e-02f,
+4.16961253e-01f,-3.57933491e-01f,-3.09445471e-01f,+5.01495413e-02f,-1.94969714e-01f,
-1.46798655e-01f,+5.76498471e-02f,+6.07967138e-01f,-2.28980426e-02f,-1.15822382e-01f,
+4.74994600e-01f,-3.91206384e-01f,-9.96996090e-02f,+1.88158542e-01f,-2.94307470e-01f,
+4.67651673e-02f,+2.89921314e-01f,+5.58900356e-01f,-1.70345664e-01f,-5.17398179e-01f,
+1.43413663e-01f,+2.39604190e-01f,-1.51310608e-01f,+3.85869771e-01f,-3.33497882e-01f,
-1.73143864e-01f,+4.19881284e-01f,+2.59773999e-01f,-1.72746584e-01f,-1.00058877e+00f,
-3.99545938e-01f,+4.17180091e-01f,+8.04052770e-01f,+9.52976346e-02f,-5.44925690e-01f,
-1.90131530e-01f,+7.50929892e-01f,-3.64962399e-01f,-2.43111879e-01f,+5.08032516e-02f,
-1.74525976e-01f,-7.14133441e-01f,+4.44413841e-01f,-6.08244300e-01f,-3.30456272e-02f,
+6.41923070e-01f,-2.85054386e-01f,-3.03777248e-01f,+2.10195139e-01f,-2.89012134e-01f,
+2.36766249e-01f,-5.90098083e-01f,+2.32102826e-01f,-8.18097591e-02f,+6.42369315e-02f,
-5.10903537e-01f,+1.29300237e-01f,+5.26842058e-01f,+7.16269985e-02f,-1.48677349e-01f,
-1.28281713e-01f,-4.46503520e-01f,-3.87365192e-01f,-3.15909058e-01f,+3.21206041e-02f,
-3.20900440e-01f,-5.65563887e-02f,+8.09675992e-01f,-3.03750634e-01f,+5.58899716e-02f,
-1.98211804e-01f,-1.69321179e-01f,-4.54920590e-01f,-7.08186388e-01f,-2.24448249e-01f,
-5.12247264e-01f,-1.63431406e-01f,-2.99777865e-01f,-3.77499223e-01f,-2.82534868e-01f,
-1.46630108e-01f,+9.90149826e-02f,+3.21933627e-01f,+8.46895754e-01f,-2.75749773e-01f,
-8.81005749e-02f,-4.67157364e-01f,-1.37406737e-01f,+6.54083848e-01f,-9.32358980e-01f,
+3.17784637e-01f,+6.50549352e-01f,-6.17896378e-01f,-1.09650955e-01f,-3.35173398e-01f,
+5.30047297e-01f,-6.98100254e-02f,-1.53561935e-01f,+4.20111045e-03f,+1.31767258e-01f,
-6.58259273e-01f,-1.49380535e-01f,+1.52377337e-01f,+6.85028195e-01f,-1.46264449e-01f,
+6.50737941e-01f,+9.19744313e-01f,+5.27684810e-03f,-7.81895936e-01f,-1.19541645e+00f,
-3.44645739e-01f,-2.33444124e-01f,-1.71804428e-01f,-4.52983409e-01f,-4.49176371e-01f,
}; 
k2c_tensor dense_kernel = {&dense_kernel_array[0],2,320,{32,10, 1, 1, 1}}; 
float dense_bias_array[10] = {
-2.09472209e-01f,+3.53792459e-01f,-1.12198718e-01f,-6.54013008e-02f,-2.72850633e-01f,
+2.29740828e-01f,-2.96893805e-01f,+8.01166520e-03f,-3.37755501e-01f,-8.46741647e-02f,
}; 
k2c_tensor dense_bias = {&dense_bias_array[0],1,10,{10, 1, 1, 1, 1}}; 
float dense_fwork[352] = {0}; 

 
k2c_conv2d(&conv2d_output,conv2d_input_input,&conv2d_kernel, 
	&conv2d_bias,conv2d_stride,conv2d_dilation,k2c_relu); 
k2c_maxpool2d(&max_pooling2d_output,&conv2d_output,max_pooling2d_pool_size, 
	max_pooling2d_stride); 
k2c_conv2d(&conv2d_1_output,&max_pooling2d_output,&conv2d_1_kernel, 
	&conv2d_1_bias,conv2d_1_stride,conv2d_1_dilation,k2c_relu); 
k2c_maxpool2d(&max_pooling2d_1_output,&conv2d_1_output,max_pooling2d_1_pool_size, 
	max_pooling2d_1_stride); 
k2c_flatten(&flatten_output,&max_pooling2d_1_output); 
k2c_dense(dense_output,&flatten_output,&dense_kernel, 
	&dense_bias,k2c_tanh,dense_fwork); 

 } 

void MNIST_CNN_initialize() { 

} 

void MNIST_CNN_terminate() { 

} 

